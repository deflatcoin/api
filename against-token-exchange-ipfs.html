<!DOCTYPE html>
<!--[if lt IE 8 ]><html class="no-js ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="no-js ie ie8" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js ie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 8)|!(IE)]><!--><html class="no-js" lang="en"> <!--<![endif]-->
<head>

<meta charset="utf-8">
<title>AGAINST Release</title>
<meta name="description" content="Fully decentralized ecosystem">
<meta name="author" content="AGAINST TEAM">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/css/default.css">
<link rel="stylesheet" href="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/css/layout.css">
<link rel="stylesheet" href="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/css/media-queries.css">
<link rel="stylesheet" href="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/css/animate.css">
<link rel="stylesheet" href="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/css/prettyPhoto.css">
<link href="/ipfs/Qmc4HhctouyDXoXqVwEVZhuiwviYWTFF4HoRLK7zraCUwj/images/favicon.png" rel="icon" />
<script src="/ipfs/QmcDwQSqEAq9j4mehdUZTy2UTyNmULuA6kAmkFqyBZr6ag/libs/jquery-3.2.1/jquery.min.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/modernizr.js"></script>
<script>
      function link(domain) {
        var loc = window.location.pathname;
        var scriptfolder = loc.substring(0, loc.lastIndexOf('/'));
        document.write("<a href='https://"+domain+scriptfolder+"' target='_blank'>"+domain+"</a>");      
      }
</script>
<style>
  .label {
    color: #006000;
    font-weight: bold;
  }
</style>
</head>
<body>
<div id="preloader">
<div id="status">
<img src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/images/preloader.gif" height="64" width="64" alt="preload">
</div>
</div>

<header>
<div class="logo">
<a class="smoothscroll" href="#hero"><img style="position:relative; top: 0;" alt="AGAINST Logo" src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/images/logo.png"></a>
</div>
<nav id="nav-wrap">
<a class="mobile-btn" href="#nav-wrap" title="Show navigation">Show Menu</a>
<a class="mobile-btn" href="#" title="Hide navigation">Hide Menu</a>
<ul id="nav" class="nav">
<li><a class="smoothscroll" href="#features">Features</a></li>
<li><a class="smoothscroll" href="#specs">Specs</a></li>
</ul> 
</nav> 
</header> 

<section id="hero">
<div class="row">
<div class="twelve columns">
<div class="hero-text">
<h1 class="responsive-headline">AGAINST COIN</h1>
<p><b>Fully decentralized ecosystem</b></p>
</div>
<div class="buttons">
<a class="button trial" target="_blank" href="https://etherscan.io/token/0xF7Be133620a7D944595683cE2B14156591EFe609" title="Etherscan Token Link (HTTP)">Token Contract</a>
<a class="button learn-more" target="_blank" href="https://github.com/deflatcoin" title="GitHub Source Code (HTTP)">GitHub</a>
</div>

</div>
</div>
</section> 

<section id='features'>
<div class="row feature design">
  <center> 
  <div style="color:#303030;">

    <h2>TOKEN EXCHANGE</h2><br>
    AGAINST TOKEN ADDRESS<br><span id="tokenAddress" class="label"></span><br>
    AGAINST RELEASE CONTRACT ADDRESS<br><span id="releaseContract" class="label"></span><br>
    AGAINST FUNDS: <span id="result" class="label"></span><br>
    PAIR TOKEN: <span id="pairTokenName" class="label"></span><br>
    PAIR ADDRESS:<br><span id="pairAddress" class="label"></span><br>
    PAIR DECIMALS: <span id="pairDecimals" class="label"></span><br>
    RATE: <span id="tokenRate" class="label"></span><br>
    FUNDS FOR BUY: <span id="buyOffer" class="label"></span><br>
    ACTIVE: <span id="tokenActive" class="label"></span><br><br>
    <script>
    var price = 1;
    let standardERC20ABI =

[{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":true,"name":"owner","type":"address"},{"indexed":true,"name":"spender","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"}] 


    let abiArray =   

[{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"rate","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_token","type":"address"}],"name":"disableToken","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_token","type":"address"}],"name":"exchangeIt","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"active","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_token","type":"address"},{"name":"_name","type":"string"},{"name":"_decimals","type":"uint256"},{"name":"_rate","type":"uint256"},{"name":"_buyoffer","type":"uint256"}],"name":"registerToken","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"tkname","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_token","type":"address"}],"name":"enableToken","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"buyoffer","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"decimals","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"comment","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]
  
   let contractAddressRelease = '0x2c882C48fcf206A18bd25523f3BA691CFCeEA83b';
   let tokenAddress = '0xF7Be133620a7D944595683cE2B14156591EFe609';
   var pairToken = '0x';
   var rate = 0;
   var pairName = 'NOT LISTED';
   var pairDecimals = 0;
   var buyOffer = 0;
   var tokenActive = false;
   var maxApprove = 0;
   var urlParams = new URLSearchParams(window.location.search);
   const contractrelease = web3.eth.contract(abiArray).at(contractAddressRelease)
   document.getElementById('tokenAddress').innerHTML = tokenAddress;
   document.getElementById('releaseContract').innerHTML = contractAddressRelease;   
   pairToken = urlParams.get('pairToken')
   document.getElementById('pairAddress').innerHTML = pairToken;

   function getERC20TokenBalance(tokenAddress, walletAddress, callback) {
      let minABI = [
        {
          "constant":true,
          "inputs":[{"name":"_owner","type":"address"}],
          "name":"balanceOf",
          "outputs":[{"name":"balance","type":"uint256"}],
          "type":"function"
        },
        {
          "constant":true,
          "inputs":[],
          "name":"decimals",
          "outputs":[{"name":"","type":"uint8"}],
          "type":"function"
        }
      ];
      let contract = web3.eth.contract(minABI).at(tokenAddress);
      contract.balanceOf(walletAddress, (error, balance) => {
        contract.decimals((error, decimals) => {
          balance = balance.div(10**decimals);
          console.log(balance.toString());
          callback(balance);
        });        
      });    
   }

    function getBalance() {     
      let walletAddress = contractAddressRelease;
      getERC20TokenBalance(tokenAddress, walletAddress, (balance) => {
          document.getElementById('result').innerHTML = balance.toString()+' AGAINST';          
          if (balance <= 0) {
              document.getElementById('getReleaseBtn').disabled = true
              document.getElementById("getReleaseBtn").style.backgroundColor = 'silver' 
              document.getElementById('result').innerText = 'No Funds - Release Ended'
          }
      })              
    }

    function getMaxApprove() {
      getERC20TokenBalance(pairToken, web3.eth.accounts[0], (result) => {
         maxApprove = result; 
         console.log(maxApprove.toString());
      }) 
    }

    function getTokenData(token) {
      const contract = web3.eth.contract(abiArray).at(contractAddressRelease);
      contract.tkname.call(token, function(err, result){  
         pairName = result;
         if (result != "") {
            document.getElementById('pairTokenName').innerHTML = result;
         } else {
            document.getElementById('pairTokenName').innerHTML = 'NOT LISTED';
         }
      })
      contract.rate.call(token, function(err, result){  
         rate = result.div(10**18);
         document.getElementById('tokenRate').innerHTML = rate+' AGAINST per '+pairName;
		 rate
      })
      contract.buyoffer.call(token, function(err, result){  
         buyOffer = result/(10**18);
         document.getElementById('buyOffer').innerHTML = buyOffer.toFixed(4) +' AGAINST';
      })
      contract.active.call(token, function(err, result){  
         tokenActive = result;
         document.getElementById('tokenActive').innerHTML = tokenActive;
         if (!tokenActive) {
            $('#qtdAGAINST').val(0);
            document.getElementById('qtdAGAINST').disabled = true
            document.getElementById("qtdAGAINST").style.backgroundColor = 'silver' 
            document.getElementById('getReleaseBtn').disabled = true
            document.getElementById("getReleaseBtn").style.backgroundColor = 'silver' 
         } 
      })
      contract.decimals.call(token, function(err, result){  
         pairDecimals = result;
         document.getElementById('pairDecimals').innerHTML = result;
      })      
    }

    </script> 
    <b>Send me <input style="height: 30px;margin-bottom: 20px;width:250px;" type="number" value="0" min="0" max="10000000000" id="qtdAGAINST"> AGAINST*<b><br>
    *Limited by user token balance or contract funds<br>   
    Contract require two Metamask Interactions<br>1-Approve spender, 2-Confirm Contract Execution<br><br>
    <button id="getReleaseBtn" class="send-button" style="height: 112px;"><b>Confirm the expense of: </b></button><br>GAS LIMIT: 200000<br>Require METAMASK</b><br>
    <div id="statust1"></div><br>
    <div id="statust2"></div><br>
    Fee rate on demand, according to the load on the network,<br>if it is too high use the edit button in Metamask<br>and change to one of the options: slow, average or fast.
    <script>
      document.getElementById('getReleaseBtn').disabled = true
      document.getElementById("getReleaseBtn").style.backgroundColor = 'silver' 
    </script>
  </div>
  <script type="text/javascript">    
    window.addEventListener('load', async () => {
      if (window.ethereum) {
        window.web3 = new Web3(ethereum);
        try {
          await ethereum.enable();
          initPayButton()
          getBalance(); 
          getMaxApprove();
          getTokenData(pairToken);  
        } catch (err) {
          $('#statust1').html('User denied account access', err)
          document.getElementById('getReleaseBtn').disabled = true
          document.getElementById("getReleaseBtn").style.backgroundColor = 'silver' 
        }
      } else if (window.web3) {
        window.web3 = new Web3(web3.currentProvider)
        initPayButton()
      } else {
        $('#statust1').html('No Metamask (or other Web3 Provider) installed')
        document.getElementById('getReleaseBtn').disabled = true
        document.getElementById("getReleaseBtn").style.backgroundColor = 'silver' 
      }
    })    
    const initPayButton = () => {
      document.getElementById('getReleaseBtn').disabled = false
      document.getElementById("getReleaseBtn").style.backgroundColor = '#4040BB' 
      var account = web3.eth.accounts[0];
      var accountInterval = setInterval(function() {
      if (web3.eth.accounts[0] !== account) {
         account = web3.eth.accounts[0];
         location.reload();
         }
      }, 100);
    
      $('#getReleaseBtn').click(() => {        
        const amountTkn = parseInt(document.getElementById('qtdAGAINST').value/rate)*(10**pairDecimals)        
        contractPair = web3.eth.contract(standardERC20ABI).at(pairToken);
        contractPair.approve(contractAddressRelease, amountTkn, {
          gas: 100000,          
        }, (err, transactionId) => {
          if  (err) {
            console.log('Transaction failed', err)
            $('#statust1').html('Transaction failed')
          } else {
            console.log('Transaction successful', transactionId)
            $('#statust1').html('Transaction successful: <a href="https://etherscan.io/tx/'+transactionId+'" target="_blank">'+transactionId+'</a>')
            const paymentAddress = contractAddressRelease
            contractrelease.exchangeIt(pairToken, {
              to: paymentAddress,
              value: 0,
              gas: 200000,          
              }, (err, transactionId) => {
              if  (err) {
                console.log('Transaction failed', err)
                $('#statust2').html('Transaction failed')
              } else {
                console.log('Transaction successful', transactionId)
                $('#statust2').html('Transaction successful: <a href="https://etherscan.io/tx/'+transactionId+'" target="_blank">'+transactionId+'</a>')
              }
            })
          }
        })
      })      
    }

    $('#qtdAGAINST').keyup(() => {      
      if ($('#qtdAGAINST').val() > buyOffer) {$('#qtdAGAINST').val(buyOffer)} 
      if ($('#qtdAGAINST').val() < 0) {$('#qtdAGAINST').val(0)} 
      if (Number($('#qtdAGAINST').val()/rate) > maxApprove) {$('#qtdAGAINST').val(maxApprove*rate)}
      $("#getReleaseBtn").html('Approve and confirm the expense of: <br> ~'+Number($('#qtdAGAINST').val()/rate).toFixed(4)+' '+pairName+' + ETH Fees<br>')  
    })

    $('#qtdAGAINST').change(() => {
      if ($('#qtdAGAINST').val() > buyOffer) {$('#qtdAGAINST').val(buyOffer)} 
      if ($('#qtdAGAINST').val() < 0) {$('#qtdAGAINST').val(0)} 
      if (Number($('#qtdAGAINST').val()/rate) > maxApprove) {$('#qtdAGAINST').val(maxApprove*rate)}
      $("#getReleaseBtn").html('Approve and confirm the expense of: <br> ~'+Number($('#qtdAGAINST').val()/rate).toFixed(4)+' '+pairName+' + ETH Fees<br>')  
    })    
      
  </script>
</center>

</div>
</section>
<section id="specs">
<div class="row feature">
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="six columns left">
<h2 style="color:white">Token Specs</h2>
<p></p>
</div>
<div class="six columns right">
<p>Platform: Ethereum Network</p>
<p>Total Supply: 1.000.000.000.000</p>
</div>
</div>
</section> 

<section id="call-to-action">
<div class="row">
<div class="seven columns">
<h2 style="text-align: center;">DEX Exchange Frontend<br><br>Over IPFS</h2>
</div>
<div class="three columns action">
<p style="text-align: center;"><a href="/ipfs/Qmc4HhctouyDXoXqVwEVZhuiwviYWTFF4HoRLK7zraCUwj/#!/trade/AGAINST-ETH" target="_blank" class="button">IPFS DEX</a><br><b>See more<br><a href="https://ipfs.io/" target="_blank">https://ipfs.io/</a></b></p>
</div>
</div>
</section> 

<footer>
<div class="row">
<p class="copyright">&copy; 2019 Woo | Design by <a title="Styleshout" href="http://www.styleshout.com/">Styleshout</a></p>
<div id="go-top">
<a class="smoothscroll" title="Back to Top" href="#hero"><i class="icon-up-open"></i></a>
</div>
</div> 
</footer> 

<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery.min.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery.flexslider.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/waypoints.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery.fittext.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery.fitvids.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/imagelightbox.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/jquery.prettyPhoto.js"></script>
<script src="/ipfs/QmTLWjJ3sPV796ZBrCndnqVsiJxS62sE63SUBaqPYVB7P9/js/main.js"></script>
</body>
</html>
